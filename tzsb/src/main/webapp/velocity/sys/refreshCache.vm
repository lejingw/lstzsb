<form id="frm" action="${rc.contextPath}/sys/cache/refresh.do" method="post">
	<input type="hidden" name="user_action" value="refresh"/>
	<input type="hidden" id="items" name="items"/>
    <table class="title">
    	<tr><td>刷新缓存#if($!message)[<font color='red'>$!message</font>]#end</td></tr>
    </table>
    <table class="control">
    	<tr>
			<td>
				<input type='button' value='刷新' class='btn' id='btnRefresh'>
			</td>
		</tr>
    </table>
    <table class='list'>
    	<thead>
			<tr>
                <th width='20px'><input type='checkbox' id='chkall'/></th>
                <th>项目编码</th>
        		<th>项目名称</th>
        		<th>刷新时间</th>
				<th style='width:60px;'></th>
            </tr>
        </thead>
        <tbody id="tbl">
			<tr>
				<td><input type='checkbox' name='chk'/></td>
				<td>user</td>
				<td>用户数据</td>
				<td>$map.user</td>
				<td><input type="button" class="btn" value="刷新" onclick="btnRefreshItem(this)"/></td>
			</tr>
			<tr>
				<td><input type='checkbox' name='chk'/></td>
				<td>dict</td>
				<td>数据字典</td>
				<td>$map.dict</td>
				<td><input type="button" class="btn" value="刷新" onclick="btnRefreshItem(this)"/></td>
			</tr>
			<tr>
				<td><input type='checkbox' name='chk'/></td>
				<td>parameter</td>
				<td>参数配置</td>
				<td>$map.parameter</td>
				<td><input type="button" class="btn" value="刷新" onclick="btnRefreshItem(this)"/></td>
			</tr>
			<tr>
				<td><input type='checkbox' name='chk'/></td>
				<td>org</td>
				<td>组织</td>
				<td>$map.org</td>
				<td><input type="button" class="btn" value="刷新" onclick="btnRefreshItem(this)"/></td>
			</tr>
    	</tbody>
    </table>
</form>
<script>
function refreshItems(items){
	jQuery("#items").val(items);
	jQuery("#frm").submit();
}
function btnRefreshItem(obj){
	var rowIndex = obj.parentNode.parentNode.rowIndex;
	refreshItems($("tbl").rows[rowIndex-1].cells[1].innerHTML);
}
jQuery(function(){
	checkTable('tbl', 'chkall', 'chk', true);
	
	jQuery("#btnRefresh").click(function(){
		var indexs = getSelectIndexs("chk");
		if(indexs.length<1){
			alert("请选择刷新的项目");
			return ;
		}
		var items = [];
		for(var i=0;i<indexs.length;i++){
			items.push($("tbl").rows[indexs[i]].cells[1].innerHTML);
		}
		refreshItems(items.join(","));
	});
});
</script>